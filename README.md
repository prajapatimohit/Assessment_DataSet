# Assessment_DataSet
This repository contains SQL scripts and analysis for the Data Craftsperson role at Incubyte. The assignment explores the provided sales dataset (assessment_dataset.csv), demonstrating proficiency in SQL and data analysis by aggregating and drilling down key metrics.

1. Overall Counts
SELECT COUNT(*) FROM TestTable;
SELECT SUM(TransactionAmount) FROM TestTable;

To understand the scale of the dataset, we extracted the total number of transactions and the total sales revenue:

Total Transactions: 500,001
Total Sales Revenue: ₹10,202,743,873.04
These figures provide an initial understanding of the dataset's size and the overall monetary volume of transactions. Further analysis will dive into breakdowns by different dimensions such as location, customer demographics, and promotional impacts.

Query 2: Sales Generated By Store_Type (Top 3 Products per Store Type)
WITH AggregatedSales AS (
    SELECT
        StoreType,
        ProductName,
        SUM(TransactionAmount) AS Total_Sales,
        AVG(DiscountPercent) AS AVG_Discount
    FROM TestTable
    GROUP BY StoreType, ProductName
),
RankedProducts AS (
    SELECT
        StoreType,
        ProductName,
        Total_Sales,
        AVG_Discount,
        ROW_NUMBER() OVER (PARTITION BY StoreType ORDER BY Total_Sales DESC) AS rn
    FROM AggregatedSales
)
SELECT
    StoreType,
    ProductName,
    Total_Sales,
    AVG_Discount
FROM RankedProducts
WHERE rn <= 3
ORDER BY StoreType, Total_Sales DESC;

Aggregation: Sales and average discount per product are calculated and ranked by store type.
Key Findings:
A row with NULL values (unclassified transactions) shows sales of about 45.73M.
In-Store:
Laptop: ~3.11B
Sofa: ~1.89B
T-Shirt: ~51M
Online:
Laptop: ~3.12B
Sofa: ~1.88B
T-Shirt: ~51M
Discount Strategy: Average discount remains around 25% across products.

Query 3: Top 5 Cities By Quantity Sold
WITH AggregatedSalesByCity AS (
    SELECT 
        City,
        SUM(TransactionAmount) AS Sales,
        SUM(Quantity) AS TotalQuantity
    FROM TestTable
    GROUP BY City
),
RankedCity AS (
    SELECT
        City,
        Sales,
        TotalQuantity,
        ROW_NUMBER() OVER (ORDER BY TotalQuantity DESC) AS rn
    FROM AggregatedSalesByCity
)
SELECT
    City,
    Sales,
    TotalQuantity
FROM RankedCity
WHERE rn <= 5
ORDER BY TotalQuantity DESC;
Aggregation:
Total sales and quantity sold were calculated for each city.

Top Cities:

Bangalore: 378,792 units sold | Sales: ~1.02B
Jaipur: 376,779 units sold | Sales: ~1.015B
Delhi: 376,397 units sold | Sales: ~1.021B
Kolkata: 375,712 units sold | Sales: ~1.027B
Chennai: 375,617 units sold | Sales: ~1.022B
Insight:
The top five cities show very similar sales figures and total quantities, indicating a balanced performance across these major regions.

-- Query 4: Average Discount by Top 5 Cities


WITH AggregatedSalesByCity AS (
    SELECT 
        City,
        SUM(TransactionAmount) AS Sales,
        SUM(Quantity) AS TotalQuantity,
        AVG(DiscountPercent) AS Avg_discount
    FROM TestTable
    GROUP BY City
),
RankedCity AS (
    SELECT
        City,
        Sales,
        TotalQuantity,
        Avg_discount,
        ROW_NUMBER() OVER (ORDER BY TotalQuantity DESC) AS rn
    FROM AggregatedSalesByCity
)
SELECT
    City,
    Sales,
    TotalQuantity,
    Avg_discount
FROM RankedCity
WHERE rn <= 5
ORDER BY TotalQuantity DESC;

Aggregation:
Total sales, total quantity, and average discount were computed for each city.

Top Cities:
The top 5 cities by quantity sold are:

Bangalore: 378,792 units; Avg Discount: ~24.95%
Jaipur: 376,779 units; Avg Discount: ~24.96%
Delhi: 376,397 units; Avg Discount: ~25.01%
Kolkata: 375,712 units; Avg Discount: ~25.02%
Chennai: 375,617 units; Avg Discount: ~24.90%
Insight:
The average discount remains consistently around 25% across these cities, indicating a uniform discounting strategy across different regions.

Query 5: Promotional Sales by City
WITH AggregatedSalesByCity AS (
    SELECT 
        City,
        SUM(TransactionAmount) AS Sales,
        SUM(Quantity) AS TotalQuantity,
        AVG(DiscountPercent) AS Avg_discount,
        SUM(CASE WHEN IsPromotional = 'YES' THEN Quantity ELSE 0 END) AS Promo_Yes,
        SUM(CASE WHEN IsPromotional = 'NO' THEN Quantity ELSE 0 END) AS Promo_No
    FROM TestTable
    GROUP BY City
),
RankedCity AS (
    SELECT
        City,
        Sales,
        TotalQuantity,
        Avg_discount,
        Promo_Yes,
        Promo_No,
        CASE 
            WHEN TotalQuantity = 0 THEN 0 
            ELSE (CAST(Promo_Yes AS FLOAT) / TotalQuantity) * 100 
        END AS Promo_Sale_Pct,
        ROW_NUMBER() OVER (ORDER BY TotalQuantity DESC) AS rn
    FROM AggregatedSalesByCity
)
SELECT
    City,
    Sales,
    TotalQuantity,
    Avg_discount,
    Promo_Yes,
    Promo_No,
    Promo_Sale_Pct
FROM RankedCity
ORDER BY TotalQuantity DESC;

Aggregation:
For each city, the query calculates:

Total sales and quantity sold.
Average discount.
Promotional sales breakdown: quantity sold under promotion (Promo_Yes) vs. non-promotional (Promo_No).
Promotional sale percentage (Promo_Sale_Pct) as the ratio of Promo_Yes to TotalQuantity.
Key Findings:

Cities like Bangalore, Jaipur, and Delhi report total quantities around 375K–379K.
The promotional sale percentage is consistently around 49-50%, suggesting nearly half of all units sold are part of promotional campaigns.
This balanced split between promotional and non-promotional sales indicates a uniform promotional strategy across major cities.
These insights help in understanding the impact of promotions on overall sales performance at the city level.

-- Query 6: Product-wise Sales and Average Shipping Cost/Delivery Time (Overall)
SELECT 
    ProductName,
    AVG(ShippingCost) AS AVG_Shipping_Cost,
    AVG(DeliveryTimeDays) AS AVG_Delivery_Time,
    SUM(TransactionAmount) AS Sales
FROM TestTable
GROUP BY ProductName
ORDER BY SUM(TransactionAmount) DESC;
Aggregation:
The query calculates the total sales, average shipping cost, and average delivery time (in days) for each product.

Key Findings:

Laptop:
Sales: ~6.23B
Avg. Shipping Cost: ~350
Avg. Delivery Time: 4 days
Sofa:
Sales: ~3.78B
Avg. Shipping Cost: ~1750
Avg. Delivery Time: 10 days
T-Shirt:
Sales: ~102M
Avg. Shipping Cost: ~47
Avg. Delivery Time: 3 days
Unclassified (NULL):
Sales: ~45.73M
Avg. Shipping Cost: ~50
Avg. Delivery Time: 7 days
Notebook:
Sales: ~24M
Avg. Shipping Cost: ~25
Avg. Delivery Time: 3 days
Apple:
Sales: ~22.3M
Avg. Shipping Cost: ~12.5
Avg. Delivery Time: 1 day
Insights:

Laptop leads in sales with moderate shipping cost and delivery time.
Sofa generates significant revenue but comes with higher shipping costs and longer delivery times.
T-Shirt, Notebook, and Apple show lower sales with correspondingly lower shipping costs and faster delivery, indicating different logistical dynamics.
The presence of an unclassified product (NULL) suggests some data entries are missing product names, which could be addressed for cleaner insights.

-- Query 7: Product-wise Sales and Average Shipping Cost/Delivery Time by City
SELECT 
    ProductName,
    City,
    AVG(ShippingCost) AS AVG_Shipping_Cost,
    AVG(DeliveryTimeDays) AS AVG_Delivery_Time,
    SUM(TransactionAmount) AS Sales
FROM TestTable
GROUP BY ProductName, City
ORDER BY SUM(TransactionAmount) DESC;
Purpose:
Aggregate sales metrics for each product in different cities, highlighting logistics and performance variations.

Key Observations:

Laptop:
High sales (~620M–630M per city)
Consistent shipping cost (~347–353)
Delivery time of 4–5 days
Sofa:
Moderate sales (~373M–382M per city)
High shipping cost (~1745–1755)
Longer delivery time (10–11 days)
T-Shirt:
Lower sales (~10–10.4M per city)
Low shipping cost (~46–48)
Quick delivery (3 days)
Unclassified (NULL):
Appears in various cities with moderate sales (~4.5–4.6M), shipping cost ~50, and 7 days delivery
Notebook & Apple:
Lower sales with very low shipping costs and fast delivery (1–3 days)
Insight:
The results reveal consistent logistics patterns per product category across cities, highlighting potential areas for operational optimization and data cleaning (e.g., unclassified products).

-- Query 8: Sales by Customer Gender and Age Group with % of Total Sales
WITH SalesCTE AS (
    SELECT 
        CustomerGender,
        CASE 
            WHEN CustomerAge BETWEEN 18 AND 25 THEN '18-25'
            WHEN CustomerAge BETWEEN 26 AND 35 THEN '26-35'
            WHEN CustomerAge BETWEEN 36 AND 55 THEN '36-55'
            WHEN CustomerAge BETWEEN 56 AND 65 THEN '56-65'
            ELSE '65+' 
        END AS Age_Group,
        AVG(LoyaltyPoints) AS avg_LoyaltyPoints,
        ROUND(SUM(TransactionAmount), 0) AS Sales
    FROM TestTable
    GROUP BY 
        CustomerGender,
        CASE 
            WHEN CustomerAge BETWEEN 18 AND 25 THEN '18-25'
            WHEN CustomerAge BETWEEN 26 AND 35 THEN '26-35'
            WHEN CustomerAge BETWEEN 36 AND 55 THEN '36-55'
            WHEN CustomerAge BETWEEN 56 AND 65 THEN '56-65'
            ELSE '65+' 
        END
)
SELECT
    CustomerGender,
    Age_Group,
    Sales,
    avg_LoyaltyPoints,
    ROUND(Sales * 100.0 / SUM(Sales) OVER (), 0) AS pct_of_total
FROM SalesCTE
ORDER BY CustomerGender, Sales;

Key Insights:
Dominant Age Group (36-55 years):

Highest sales across all genders (~1.18B per group).
Holds 12% of total sales, making it the most valuable segment.
Sales Distribution by Gender:

Male, Female, and Other genders have similar purchase behaviors across age groups.
The 36-55 age group contributes the highest revenue for all genders.
Young buyers (18-25) and senior buyers (65+) contribute the least (~5% each).
Loyalty Points Insights:

Age group 18-25 and 36-55 have slightly higher average loyalty points (~5013-5020).
Older customers (65+) have slightly lower loyalty points (~4962-5000), indicating possible lower engagement in loyalty programs.
Overall Sales Contribution by Age:

Mid-aged customers (26-65) drive most sales (~24%) of total revenue.
Senior customers (65+) contribute only ~5%, despite having significant sales.
Potential Business Actions:
Target the 36-55 age group:
Since they have the highest spending, create premium offers and loyalty incentives.
Engage younger (18-25) and senior (65+) customers:
Use discounts, subscriptions, or personalized promotions to boost engagement in these lower-spending groups.
Enhance loyalty programs for older customers (65+):
Given their lower loyalty points, encourage retention via personalized rewards.
Overall, this analysis provides a roadmap for customer segmentation, targeted marketing, and improving sales strategies.

-- Query 9: Returned Orders by Region
SELECT 
    Region,
    SUM(CASE WHEN Returned = 'Yes' THEN 1 ELSE 0 END) AS Returned_Order, 
    ROUND(SUM(TransactionAmount), 0) AS Sales
FROM TestTable
GROUP BY Region
ORDER BY Sales;
Key Insights:
Highest Sales & Returns in the South:

Sales: $3.18B (highest among all regions).
Returned Orders: 72,796 (highest return count).
Potential issue: Higher sales may naturally result in more returns, but further investigation is needed to check for quality/service issues.
East Region Has the Second-Highest Returns:

Sales: $2.65B
Returned Orders: 59,455
Return rates need review, possibly due to product fit issues, customer dissatisfaction, or supply chain problems.
North & West Show Similar Return Trends:

North Sales: $2.17B | Returned Orders: 47,992
West Sales: $2.16B | Returned Orders: 47,963
Return numbers are similar, indicating consistent patterns in these regions.
NULL Region Data:

Sales: $39M (very low compared to others).
Returned Orders: 21,261
Data quality issue? NULL values in the region column may indicate missing or improperly classified location data.

-- Query 10: Returned Orders by Product
SELECT  
    ProductName,
    SUM(CASE WHEN Returned = 'Yes' THEN 1 ELSE 0 END) AS Returned_Order, 
    ROUND(SUM(TransactionAmount), 0) AS Sales
FROM TestTable
GROUP BY ProductName
ORDER BY Sales;
Key Insights:
Laptops Have the Highest Sales & Returns:

Sales: $6.23B (highest).
Returned Orders: 44,904.
Possible Reasons:
Defective products or wrong specifications upon delivery.
High-value purchases lead to careful customer scrutiny.
Better return policies for expensive items?
Sofas Have the Second-Highest Sales & Returns:

Sales: $3.78B.
Returned Orders: 44,696.
Possible Reasons:
Size or color mismatch with expectations.
Delivery damages due to handling issues.
Difficult returns logistics—returning furniture is costly.
T-Shirts Show Moderate Sales but High Returns:

Sales: $102M.
Returned Orders: 44,783.
Possible Reasons:
Size and fit issues.
Material or quality concerns.
Frequent impulse buys, leading to high return rates.
Low Sales Items (Apple, Notebook) Still Have High Returns:

Apple Sales: $22.3M | Returned Orders: 45,033
Notebook Sales: $24.1M | Returned Orders: 45,061
Very high return rate relative to sales volume!
Likely defective items or low perceived value.
NULL Product Data:

Sales: $45.7M.
Returned Orders: 24,990.
Data Issue: Missing product names affect accurate analysis.

